from imutils import paths
from PIL import Image
import os
import shutil


def stitching():

  # replace with new directory
  image_folder = r''
  imagePaths = list(paths.list_images(image_folder))
  images = [Image.open(x) for x in imagePaths]
  widths, heights = zip(*(i.size for i in images))

  total_width = sum(widths)
  max_height = max(heights)

  new_im = Image.new('RGB', (total_width, max_height))

  x_offset = 0
  for im in images:
    new_im.paste(im, (x_offset,0))
    x_offset += im.size[0]

  new_im.save('stitchedImages/stitchedOutput.png', format='png')


# for root, dirs, files in os.walk("/runs"):
#   for file in files:
#     if file.endswith(".txt"):
#       print(os.path.join(root, file))

i=1
for root, dirs, files in os.walk("runs", topdown=False):
   for name in files:
      
      path = os.path.join(root, name)
      print(path)
      source_path = os.path.join(r"C:\Users\ASUS\Desktop\mdp\mdpv1_yolov5", path)
      print("Copying from" + source_path)
      dest_path = r"C:\Users\ASUS\Desktop\mdp\mdpv1_yolov5\stitchedImages"
      
      while os.path.exists("image%s.jpg" % i):
        i += 1
        # os.rename(old_name, new_name)

      shutil.copy(source_path, dest_path)
